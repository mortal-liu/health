<!DOCTYPE html>
<html lang="zh-CN"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>168 + é«˜å¼ºåº¦è®­ç»ƒ | ç”Ÿç‰©ä¼˜åŒ–ä»ªè¡¨ç›˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; background-color: #F9FAFB; color: #374151; }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 600px; 
            height: 300px; 
            margin: 0 auto;
        }
        /* Custom scrollbar for cleanliness */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .card-hover { transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        
        .active-tab { border-bottom: 2px solid #0D9488; color: #0D9488; font-weight: 600; }
        .inactive-tab { color: #6B7280; }
        .inactive-tab:hover { color: #374151; }
    </style>
    <!-- Chosen Palette: Teal & Warm Neutral. 
         Background: #F9FAFB (Cool Gray 50)
         Primary: #0D9488 (Teal 600) - Represents health, balance, and bio-optimization.
         Secondary: #F59E0B (Amber 500) - Energy, warnings, metabolic fire.
         Text: #374151 (Gray 700) - High readability.
    -->
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- Application Structure Plan:
         1. Header: Quick summary of the user's protocol (168 + 1h Strength + 40min Cardio).
         2. Dashboard Controls (The Command Center): Interactive inputs for weight and sleep. This personalizes all data below.
         3. The Circadian Visualizer (Time): A visual bar chart showing the 24h cycle. The goal is to optimize WHEN to eat vs. train.
         4. Metabolic Engine (Nutrition): Dynamic macro calculator specifically for high volume + fasting.
         5. Recovery Analytics (Risk Management): Assessing the high training load. Radar chart for "System Readiness".
         6. The "Yang Sheng" Knowledge Base: Accordion-style deep dives into cortisol, supplements, and sleep hygiene.
         
         Why this structure? 
         The user is a "bio-hacker" type (20yo male, strict regimen). He needs data first, then actionable tools, then theory. 
         The dashboard approach allows him to see the "Health of the System" at a glance.
    -->

    <!-- Header Section -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <span class="text-2xl text-teal-600">âš¡</span>
                <div>
                    <h1 class="text-xl font-bold text-gray-900">Bio-Optimization Protocol</h1>
                    <p class="text-xs text-gray-500">168 Fasting â€¢ Hypertrophy â€¢ Cardio Endurance</p>
                </div>
            </div>
            <nav class="hidden md:flex space-x-6 text-sm">
                <button onclick="scrollToSection('dashboard')" class="text-gray-600 hover:text-teal-600">ä»ªè¡¨ç›˜</button>
                <button onclick="scrollToSection('nutrition')" class="text-gray-600 hover:text-teal-600">è¥å…»ç­–ç•¥</button>
                <button onclick="scrollToSection('recovery')" class="text-gray-600 hover:text-teal-600">æ·±åº¦æ¢å¤</button>
            </nav>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full space-y-8">

        <!-- Intro Context -->
        <section class="bg-white rounded-xl p-6 shadow-sm border-l-4 border-teal-500">
            <h2 class="text-lg font-bold text-gray-800 mb-2">ğŸ‘‹ æ¬¢è¿å›æ¥ï¼Œå¹´è½»çš„æˆ˜å£«</h2>
            <p class="text-gray-600 leading-relaxed">
                ä½ æ­£åœ¨æ‰§è¡Œä¸€ä¸ªéå¸¸æ¿€è¿›ä¸”é«˜æ•ˆçš„æ–¹æ¡ˆï¼š<strong>168è½»æ–­é£Ÿ + æ¯æ—¥100åˆ†é’Ÿæ··åˆè®­ç»ƒ</strong>ã€‚å¯¹äº20å²ç”·æ€§ï¼Œè¿™æ˜¯é‡å¡‘ä½“å‹å’Œæå‡å¿ƒè‚ºçš„é»„é‡‘ç»„åˆï¼Œä½†åŒæ—¶ä¹Ÿä¼´éšç€<strong>çš®è´¨é†‡ç§¯ç´¯</strong>å’Œ<strong>è‚Œè‚‰æµå¤±</strong>çš„é£é™©ã€‚æœ¬ä»ªè¡¨ç›˜æ—¨åœ¨å¸®åŠ©ä½ ç›‘æ§èº«ä½“è´Ÿè·ï¼Œç²¾å‡†è®¡ç®—çª—å£æœŸçš„è¥å…»æ‘„å…¥ï¼Œå°†â€œå…»ç”Ÿâ€è½¬åŒ–ä¸ºç§‘å­¦çš„â€œç”Ÿç‰©ä¼˜åŒ–â€ã€‚
            </p>
        </section>

        <!-- DASHBOARD CONTROLS -->
        <section id="dashboard" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- User Inputs -->
            <div class="bg-white p-6 rounded-xl shadow-sm card-hover col-span-1">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-gray-800">âš™ï¸ å‚æ•°è®¾å®š</h3>
                    <span class="text-xs bg-teal-100 text-teal-800 px-2 py-1 rounded-full">å®æ—¶è®¡ç®—</span>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">å½“å‰ä½“é‡ (kg)</label>
                        <input type="number" id="weightInput" value="70" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-teal-500 focus:border-teal-500" oninput="updateDashboard()">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ç¬¬ä¸€é¤æ—¶é—´ (è¿›é£Ÿçª—å£å¼€å§‹)</label>
                        <select id="startTime" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-teal-500 focus:border-teal-500" onchange="updateDashboard()">
                            <option value="8">08:00 (æ—©é¸Ÿæ¨¡å¼)</option>
                            <option value="10">10:00 (å¹³è¡¡æ¨¡å¼)</option>
                            <option value="12" selected>12:00 (ç»å…¸æ¨¡å¼)</option>
                            <option value="14">14:00 (æ™šé—´è®­ç»ƒ)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ç¡çœ è´¨é‡ (æ˜¨æ™š)</label>
                        <input type="range" id="sleepQuality" min="1" max="10" value="7" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-teal-600" oninput="updateRecovery()">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>ç³Ÿç³•</span>
                            <span id="sleepValueDisplay">7/10</span>
                            <span>å®Œç¾</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics Visual -->
            <div class="bg-white p-6 rounded-xl shadow-sm card-hover col-span-1 lg:col-span-2">
                <h3 class="font-bold text-gray-800 mb-4">ğŸ“Š 24å°æ—¶ æ˜¼å¤œèŠ‚å¾‹ä¸è·å°”è’™æ¨¡æ‹Ÿ</h3>
                <p class="text-sm text-gray-500 mb-4">æ­¤å›¾è¡¨å±•ç¤ºäº†åœ¨ä½ å½“å‰çš„168è®¡åˆ’ä¸‹ï¼Œçš®è´¨é†‡ï¼ˆå‹åŠ›/æ¸…é†’ï¼‰ä¸èƒ°å²›ç´ ï¼ˆè¿›é£Ÿ/å‚¨å­˜ï¼‰çš„ç†æƒ³æ³¢åŠ¨æ›²çº¿ã€‚ç›®æ ‡æ˜¯è®©é«˜å¼ºåº¦è®­ç»ƒé¿å¼€æ·±ç¡åŒºï¼Œè®©è¿›é£Ÿçª—å£è¦†ç›–è®­ç»ƒåçš„åˆæˆä»£è°¢æœŸã€‚</p>
                <div class="chart-container">
                    <canvas id="circadianChart"></canvas>
                </div>
            </div>
        </section>

        <!-- NUTRITION SECTION -->
        <section id="nutrition" class="space-y-6">
            <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">ğŸ¥©</span>
                <h2 class="text-2xl font-bold text-gray-800">ç²¾å‡†è¥å…»ç­–ç•¥ (The 8-Hour Fuel)</h2>
            </div>
            <p class="text-gray-600">ç”±äºä½ æœ‰æ¯æ—¥1å°æ—¶åŠ›é‡+40åˆ†é’Ÿæœ‰æ°§çš„å·¨å¤§æ¶ˆè€—ï¼Œå•çº¯çš„â€œå°‘åƒâ€ä¼šå¯¼è‡´ä»£è°¢æŸä¼¤ã€‚ä½ éœ€è¦åœ¨ä¸€ä¸ªå‹ç¼©çš„8å°æ—¶çª—å£å†…æ‘„å…¥è¶³å¤Ÿçš„ç‡ƒæ–™ã€‚</p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Macro Calculator -->
                <div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-amber-500">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">æ¯æ—¥å®é‡è¥å…»ç´ ç›®æ ‡</h3>
                    <div class="flex justify-between items-end mb-6">
                        <div>
                            <span class="text-4xl font-bold text-gray-900" id="totalCalories">2650</span>
                            <span class="text-sm text-gray-500">kcal / æ—¥</span>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-600">åŸºç¡€ä»£è°¢ + è¿åŠ¨æ¶ˆè€—</div>
                            <div class="text-xs text-amber-600 font-bold">ç›ˆä½™/èµ¤å­—: ç»´æŒæœŸ</div>
                        </div>
                    </div>
                    
                    <!-- Macro Bars -->
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">è›‹ç™½è´¨ (ä¿®å¤è‚Œè‚‰)</span>
                                <span id="proteinTarget" class="text-teal-600 font-bold">160g</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-teal-600 h-2.5 rounded-full" style="width: 35%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">å…³é”®ï¼šæ¯é¤è‡³å°‘40gï¼Œç¡®ä¿äº®æ°¨é…¸é˜ˆå€¼ã€‚</p>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">ç¢³æ°´åŒ–åˆç‰© (ç³–åŸå¡«å……)</span>
                                <span id="carbTarget" class="text-blue-600 font-bold">300g</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-blue-600 h-2.5 rounded-full" style="width: 45%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">å…³é”®ï¼šä¸»è¦é›†ä¸­åœ¨è®­ç»ƒå‰åï¼Œå…¶ä½™æ—¶é—´åƒä½GIã€‚</p>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="font-medium">è„‚è‚ª (æ¿€ç´ åˆæˆ)</span>
                                <span id="fatTarget" class="text-amber-600 font-bold">70g</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-amber-500 h-2.5 rounded-full" style="width: 20%"></div>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">å…³é”®ï¼šè¿œç¦»è®­ç»ƒæ—¶é—´æ‘„å…¥ï¼Œä»¥å…å‡ç¼“æ¶ˆåŒ–ã€‚</p>
                        </div>
                    </div>
                </div>

                <!-- Meal Timing Strategy -->
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="font-bold text-lg text-gray-800 mb-4">è¿›é£Ÿçª—å£å¯è§†åŒ–</h3>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="macroChart"></canvas>
                    </div>
                    <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                        <h4 class="font-bold text-blue-800 text-sm">ğŸ’¡ è®­ç»ƒæ—¶æœºå»ºè®®</h4>
                        <p class="text-sm text-blue-700 mt-1" id="trainingTimingAdvice">
                            æ­£åœ¨è®¡ç®—æœ€ä½³å»ºè®®...
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- RECOVERY & RISK MANAGEMENT -->
        <section id="recovery" class="space-y-6">
            <div class="flex items-center space-x-2 mb-2">
                <span class="text-2xl">â¤ï¸â€ğŸ©¹</span>
                <h2 class="text-2xl font-bold text-gray-800">ç³»ç»Ÿæ¢å¤ä¸é£é™©æ§åˆ¶ (System Recovery)</h2>
            </div>
            <p class="text-gray-600">é«˜å®¹é‡è®­ç»ƒ (1håŠ›é‡+40minæœ‰æ°§) æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„â€œé˜´â€ï¼ˆæ¢å¤ï¼‰ï¼Œè¿‡å¤šçš„â€œé˜³â€ï¼ˆè®­ç»ƒï¼‰ä¼šå¯¼è‡´çš®è´¨é†‡é•¿æœŸå‡é«˜ï¼Œä¸ä»…ä¸æ‰ç§¤ï¼Œåè€Œå¯¼è‡´æ°´è‚¿å’Œè…¹éƒ¨è„‚è‚ªå †ç§¯ã€‚</p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Readiness Radar -->
                <div class="bg-white p-6 rounded-xl shadow-sm lg:col-span-1">
                    <h3 class="font-bold text-gray-800 mb-2">ä»Šæ—¥èº«ä½“å°±ç»ªåº¦</h3>
                    <p class="text-xs text-gray-500 mb-4">åŸºäºä½ çš„ç¡çœ å’Œè®­ç»ƒå¼ºåº¦ä¼°ç®—ã€‚</p>
                    <div class="chart-container" style="height: 280px;">
                        <canvas id="readinessChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                        <span id="readinessScore" class="text-2xl font-bold text-teal-600">85%</span>
                        <p class="text-sm text-gray-600">çŠ¶æ€è¯„ä»·: <span id="readinessText">è‰¯å¥½</span></p>
                    </div>
                </div>

                <!-- Checklist & Knowledge -->
                <div class="bg-white p-6 rounded-xl shadow-sm lg:col-span-2 flex flex-col justify-between">
                    <div>
                        <h3 class="font-bold text-gray-800 mb-4">æ¯æ—¥å…»ç”Ÿæ¸…å• (Checklist)</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div class="flex items-start space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer" onclick="toggleCheck(this)">
                                <div class="w-6 h-6 rounded border-2 border-gray-300 bg-white flex items-center justify-center text-white font-bold select-none check-box">âœ“</div>
                                <div>
                                    <p class="font-bold text-sm text-gray-800">æ—©æ™¨ï¼šå…‰ç…§ä¸æ°´</p>
                                    <p class="text-xs text-gray-500">èµ·åºŠå500mlæ¸©æ°´ + 5åˆ†é’Ÿé˜³å…‰ç›´å°„ï¼ˆè°ƒèŠ‚æ˜¼å¤œèŠ‚å¾‹ï¼‰ã€‚</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer" onclick="toggleCheck(this)">
                                <div class="w-6 h-6 rounded border-2 border-gray-300 bg-white flex items-center justify-center text-white font-bold select-none check-box">âœ“</div>
                                <div>
                                    <p class="font-bold text-sm text-gray-800">è®­ç»ƒåï¼šçš®è´¨é†‡æ§åˆ¶</p>
                                    <p class="text-xs text-gray-500">æœ‰æ°§ç»“æŸåï¼Œåš5åˆ†é’Ÿâ€œç®±å¼å‘¼å¸â€æˆ–æ‹‰ä¼¸ï¼Œå¼ºåˆ¶å‰¯äº¤æ„Ÿç¥ç»å¯åŠ¨ã€‚</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer" onclick="toggleCheck(this)">
                                <div class="w-6 h-6 rounded border-2 border-gray-300 bg-white flex items-center justify-center text-white font-bold select-none check-box">âœ“</div>
                                <div>
                                    <p class="font-bold text-sm text-gray-800">å¾®é‡å…ƒç´ è¡¥å……</p>
                                    <p class="text-xs text-gray-500">é”Œé•(ZMA) + å¤åˆBæ—ã€‚å¤§é‡å‡ºæ±—ä¼šæµå¤±ç”µè§£è´¨ã€‚</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition cursor-pointer" onclick="toggleCheck(this)">
                                <div class="w-6 h-6 rounded border-2 border-gray-300 bg-white flex items-center justify-center text-white font-bold select-none check-box">âœ“</div>
                                <div>
                                    <p class="font-bold text-sm text-gray-800">ç¡å‰ï¼šç”µå­å®µç¦</p>
                                    <p class="text-xs text-gray-500">ç¡å‰1å°æ—¶ä½©æˆ´é˜²è“å…‰çœ¼é•œæˆ–ä¸çœ‹æ‰‹æœºã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 border-t pt-4">
                        <h4 class="font-bold text-sm text-red-500 mb-2">âš ï¸ ç›‘æ§è¿™äº›è¿‡åŠ³ä¿¡å·</h4>
                        <div class="flex flex-wrap gap-2">
                            <span class="px-2 py-1 bg-red-50 text-red-700 text-xs rounded-md border border-red-100">é™æ¯å¿ƒç‡å‡é«˜</span>
                            <span class="px-2 py-1 bg-red-50 text-red-700 text-xs rounded-md border border-red-100">æŒç»­å…³èŠ‚ç—›</span>
                            <span class="px-2 py-1 bg-red-50 text-red-700 text-xs rounded-md border border-red-100">æ€§æ¬²ä¸‹é™</span>
                            <span class="px-2 py-1 bg-red-50 text-red-700 text-xs rounded-md border border-red-100">å¤±çœ /æ—©é†’</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Visualization & Content Choices:
             1. Circadian Chart (Line): Goal is to visualize abstract concepts (hormones) against concrete actions (eating/training). Shows overlap risks.
             2. Macro Bars (Simple HTML/CSS): Direct, quantitative feedback on nutrition needs.
             3. Meal Timing (Pie/Doughnut): Visualizes the "Window" concept intuitively.
             4. Readiness Radar (Radar): Holistic view of health, moving away from just "weight" or "calories" to "lifestyle balance".
             All using Chart.js as requested. No SVG.
        -->

    </main>

    <footer class="bg-white border-t border-gray-200 mt-8 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-500 text-sm">æ­¤å·¥å…·ä»…ä¾›å¥åº·å‚è€ƒã€‚è‹¥å‡ºç°èº«ä½“ä¸é€‚ï¼Œè¯·ç«‹å³åœæ­¢æ–­é£Ÿå¹¶å’¨è¯¢åŒ»ç”Ÿã€‚</p>
            <div class="mt-2 text-xs text-gray-400">Bio-Optimization Dashboard â€¢ v1.0</div>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        // State Management
        const state = {
            weight: 70,
            startTime: 12, // 12:00
            sleepQuality: 7,
            activityFactor: 1.6 // High activity (1h strength + 40m cardio)
        };

        // Chart Instances
        let circadianChartInstance = null;
        let macroChartInstance = null;
        let readinessChartInstance = null;

        // Initialization
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            updateDashboard();
        });

        function toggleCheck(el) {
            const checkbox = el.querySelector('.check-box');
            if (checkbox.classList.contains('bg-teal-500')) {
                checkbox.classList.remove('bg-teal-500', 'border-teal-500');
                checkbox.classList.add('bg-white', 'border-gray-300');
            } else {
                checkbox.classList.remove('bg-white', 'border-gray-300');
                checkbox.classList.add('bg-teal-500', 'border-teal-500');
            }
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Data Processing & UI Updates
        function updateDashboard() {
            // Get inputs
            state.weight = parseFloat(document.getElementById('weightInput').value) || 70;
            state.startTime = parseInt(document.getElementById('startTime').value);
            
            // Calculate Calories & Macros
            // BMR (Mifflin-St Jeor approx) = 10*W + 6.25*H(est 175) - 5*A(20) + 5
            const bmr = (10 * state.weight) + (6.25 * 175) - (5 * 20) + 5;
            const tdee = Math.round(bmr * state.activityFactor);
            
            // Goals: High Protein (2.2g/kg), Mod Fat (1g/kg), Rest Carbs
            const protein = Math.round(state.weight * 2.2);
            const fat = Math.round(state.weight * 1.0);
            const carb = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);

            // Update DOM
            document.getElementById('totalCalories').innerText = tdee;
            document.getElementById('proteinTarget').innerText = `${protein}g`;
            document.getElementById('fatTarget').innerText = `${fat}g`;
            document.getElementById('carbTarget').innerText = `${carb}g`;

            // Update Advice
            const endTime = (state.startTime + 8) % 24;
            const endTimeStr = endTime < 10 ? `0${endTime}:00` : `${endTime}:00`;
            const startTimeStr = state.startTime < 10 ? `0${state.startTime}:00` : `${state.startTime}:00`;
            
            let advice = "";
            if (state.startTime >= 12) {
                advice = `ä½ çš„è¿›é£Ÿçª—å£æ˜¯ ${startTimeStr} - ${endTimeStr}ã€‚å»ºè®®åœ¨ ${state.startTime - 2}:00 å·¦å³è¿›è¡Œç©ºè…¹è®­ç»ƒï¼ˆç‡ƒè„‚æ•ˆç‡æœ€é«˜ï¼‰ï¼Œè®­ç»ƒåç«‹å³æ‰“ç ´æ–­é£Ÿæ‘„å…¥é«˜å‡ç³–ç¢³æ°´å’Œè›‹ç™½ã€‚`;
            } else {
                advice = `ä½ çš„è¿›é£Ÿçª—å£æ˜¯ ${startTimeStr} - ${endTimeStr}ã€‚å¦‚æœä½ åœ¨æ™šä¸Šè®­ç»ƒï¼Œæ³¨æ„åœ¨çª—å£ç»“æŸå‰æ‘„å…¥é…ªè›‹ç™½ï¼ˆå¦‚å¸Œè…Šé…¸å¥¶ï¼‰ä»¥é˜²æ­¢å¤œé—´è‚Œè‚‰æµå¤±ã€‚`;
            }
            document.getElementById('trainingTimingAdvice').innerText = advice;

            updateCharts();
        }

        function updateRecovery() {
            state.sleepQuality = parseInt(document.getElementById('sleepQuality').value);
            document.getElementById('sleepValueDisplay').innerText = `${state.sleepQuality}/10`;
            updateReadinessChart();
        }

        // --- CHARTS ---

        function initCharts() {
            // 1. Circadian Chart
            const ctx1 = document.getElementById('circadianChart').getContext('2d');
            circadianChartInstance = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [
                        {
                            label: 'ç†æƒ³çš®è´¨é†‡ (èƒ½é‡/å‹åŠ›)',
                            data: [], // dynamic
                            borderColor: '#F59E0B', // Amber
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        },
                        {
                            label: 'ç†æƒ³èƒ°å²›ç´  (è¿›é£Ÿçª—å£)',
                            data: [], // dynamic
                            borderColor: '#0D9488', // Teal
                            backgroundColor: 'rgba(13, 148, 136, 0.2)',
                            fill: true,
                            tension: 0.1,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: { display: false, min: 0, max: 100 },
                        x: { grid: { display: false } }
                    }
                }
            });

            // 2. Meal Timing Chart (Donut)
            const ctx2 = document.getElementById('macroChart').getContext('2d');
            macroChartInstance = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['ç¦é£Ÿ/ç‡ƒè„‚æœŸ (HGHå‡é«˜)', 'è¿›é£Ÿçª—å£ (èƒ°å²›ç´ å‡é«˜)'],
                    datasets: [{
                        data: [16, 8],
                        backgroundColor: ['#E5E7EB', '#0D9488'], // Gray, Teal
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });

            // 3. Readiness Chart (Radar)
            const ctx3 = document.getElementById('readinessChart').getContext('2d');
            readinessChartInstance = new Chart(ctx3, {
                type: 'radar',
                data: {
                    labels: ['ç¡çœ è´¨é‡', 'è¥å…»æ‘„å…¥', 'è‚Œè‚‰é…¸ç—›', 'å¿ƒå¢ƒ', 'é£Ÿæ¬²'],
                    datasets: [{
                        label: 'å½“å‰çŠ¶æ€',
                        data: [7, 8, 6, 7, 8],
                        fill: true,
                        backgroundColor: 'rgba(13, 148, 136, 0.2)',
                        borderColor: '#0D9488',
                        pointBackgroundColor: '#0D9488',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#0D9488'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { display: true },
                            suggestedMin: 0,
                            suggestedMax: 10,
                            ticks: { display: false } // Hide numbers for cleaner look
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function updateCharts() {
            // Update Circadian Data
            const cortisolData = [];
            const insulinData = [];
            
            for (let i = 0; i < 24; i++) {
                // Mock Cortisol Curve (Peak morning, drop night)
                // Peak at 8am, low at midnight
                let cortisol = Math.max(0, 100 - Math.abs(i - 8) * 6);
                if (i < 5) cortisol = 20 + i * 5; // Rise before waking
                
                // Add workout spike (Assume workout 2 hours before first meal or at 17:00 if late eater)
                let workoutTime = state.startTime - 2; 
                if (workoutTime < 6) workoutTime = 17; // Default to evening if early eater logic fails visual
                
                if (i >= workoutTime && i < workoutTime + 2) {
                     cortisol += 40; // Spike during workout
                }
                
                // Mock Insulin Curve (Based on window)
                const windowEnd = (state.startTime + 8);
                let insulin = 10; // Baseline
                if (i >= state.startTime && i < windowEnd) {
                    insulin = 80; // High during eating
                }
                
                cortisolData.push(Math.min(100, cortisol));
                insulinData.push(insulin);
            }

            circadianChartInstance.data.datasets[0].data = cortisolData;
            circadianChartInstance.data.datasets[1].data = insulinData;
            circadianChartInstance.update();

            // Update Readiness
            updateReadinessChart();
        }

        function updateReadinessChart() {
            // Simple logic: Impact of high activity vs sleep
            const sleep = state.sleepQuality;
            // High activity drains "Soreness" score if sleep is low
            let sorenessScore = sleep > 7 ? 8 : (sleep > 5 ? 6 : 4);
            let moodScore = sleep > 6 ? 8 : 5;
            
            // Appetite increases with activity but drops with overtraining
            let appetiteScore = 8; 
            
            // Nutrition score assumed high (goal setting)
            let nutritionScore = 9;

            const newData = [sleep, nutritionScore, sorenessScore, moodScore, appetiteScore];
            readinessChartInstance.data.datasets[0].data = newData;
            readinessChartInstance.update();

            // Calculate Score
            const total = newData.reduce((a, b) => a + b, 0);
            const max = 50;
            const percentage = Math.round((total / max) * 100);
            
            const scoreEl = document.getElementById('readinessScore');
            const textEl = document.getElementById('readinessText');
            
            scoreEl.innerText = `${percentage}%`;
            
            if (percentage > 85) {
                scoreEl.className = "text-2xl font-bold text-teal-600";
                textEl.innerText = "å·…å³°çŠ¶æ€ - å¯ä»¥æŒ‘æˆ˜PR";
            } else if (percentage > 65) {
                scoreEl.className = "text-2xl font-bold text-amber-500";
                textEl.innerText = "æ­£å¸¸ - ä¿æŒè®­ç»ƒå¼ºåº¦";
            } else {
                scoreEl.className = "text-2xl font-bold text-red-500";
                textEl.innerText = "ç–²åŠ³ - å»ºè®®æ”¹ä¸ºä¸»åŠ¨æ¢å¤";
            }
        }

    </script>
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</body>
</html>